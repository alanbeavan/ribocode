#!/bin/bash
#SBATCH --partition=defq
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=1
#SBATCH --mem=20g
#SBATCH --time=7-00:00:00
#SBATCH --array=0-99
#should be 4 on each job

echo "Running on `hostname`"
cd ${SLURM_SUBMIT_DIR}

j = 0
for i in 470 484 285 485 245 358 426 305 252 474 376 353 455 420 421 257 65 271 388 76 89 414 171 166 328 273 86 390 47 462 62 382 400 68 313 214 440 293 450 403 222 429 126 372 446 393 337 394 246 56 334 448 384 269 52 302 278 416 72 95 112 277 354 430 296 360 392 415 344 310 413 250 335 368 346 469 234 290 188 442 151 238 350 451 460 481 408 167 483 145 169 471 119 182 445 383 98 136 194 228 233 242 200 297 140 378 241 176 323 362 444 195 322 230 468 319 159 375 212 141 266 262 64 441 289 149 196 480 186 229 380 205 330 206 443 487 312 236 399 144 456 104 130 131 207 449 477 138 208 347 209 339 438 178 419 391 225 231 417 198 324 286 79 333 352 82 397 147 179 431 340 283 135 165 172 197 311 211 386 476 187 424 226 129 114 473 215 418 199 105 174 401 224 185 137 158 193 381 181 217 153 202 218 156 219 396 75 203 177 142 221 150 191 489 258 192 152 433 168 184 170 210 175 32 117 321 259 213 479 163 223 459 160 93 173 87 201 125 157 298 162 189 96 101 284 27 84 260 282 279 255 133 359 405 115 379 364 77 111 292 139 155 109 134 356 482 148 69 309 317 428 116 367 70 439 154 58 374 315 123 106 51 14 127 385 164 67 387 100 261 23 74 275 365 299 31 235 303 254 411 99 21 54 268 81 39 35 370 239 240 78 90 331 461 320 66 422 475 122 128 0 244 49 308 118 409 91 410 220 45 349 371 216 466 43 404 37 161 73 336 25 247 377 338 458 251 276 97 304 472 327 343 249 48 406 107 40 407 332 121 183 389 351 110 204 478 143 227 94 288 291 366 61 270 274 71 38 11 13 113 26 243 326 57 265 46 452 425 465 253 453 457 190 463 436 329 59 18 363; do
    if [[ $((j%100)) == ${SLURM_ARRAY_TASK_ID} ]]; then
        if [ ! -f alignments/group_${i}.aln.mafft ]; then
            mafft merged_by_50/group_${i}.fa > alignments/group_${i}.aln.mafft
        fi
        fasttree alignments/group_${i}.aln.mafft > nj_trees/group_${i}_nj.tree
    fi
    j=$((j+1))
done

sleep 40
echo "Finished job now"
